<!DOCTYPE HTML>
<html>
    <head>
        <title>Map Example</title>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
        <style>
            #map {
                width: 100%;
                height: 400px;
            }
            .order-form {
    width: 60%; /* Adjust as needed */
    margin: 0 auto; /* Centers the form horizontally */
    padding: 20px; /* Adds some padding to the form */
    border: 1px solid gray; /* Adds a border to the form */
    border-radius: 5px; /* Rounds the corners of the border */
    background-color: #f5f5f5; /* Sets the background color of the form */
}

.form-group {
    margin-bottom: 20px; /* Adds some margin between form elements */
}

.form-control {
    width: 100%; /* Makes the form elements take up the full width of the form */
    padding: 12px; /* Adds some padding to the form elements */
    border-radius: 5px; /* Rounds the corners of the form elements */
    border: 1px solid gray; /* Adds a border to the form elements */
    box-sizing: border-box; /* Makes sure the padding and border are included in the total width */
}

.form-control:focus {
    border-color: #4CAF50; /* Changes the border color when the element is focused */
    box-shadow: 0 0 0 0.2rem rgba(76,175,80,0.25); /* Adds a shadow when the element is focused */
}

input[type="submit"] {
    background-color: #4CAF50; /* Sets the background color of the submit button */
    color: white; /* Sets the text color of the submit button */
    padding: 12px 20px; /* Adds some padding to the submit button */
    border: none; /* Removes the border from the submit button */
    border-radius: 4px; /* Rounds the corners of the submit button */
    cursor: pointer; /* Changes the cursor to a pointer when hovered over the submit button */
    margin-top: 20px; /* Adds some margin between the submit button and the form elements */
    width: 100%; /* Makes the submit button take up the full width of the form */
}

input[type="submit"]:hover {
    background-color: #45a049; /* Changes the background color of the submit button when hovered over */
}
button {
    background-color: #4CAF50; /* Sets the background color of the submit button */
    color: white; /* Sets the text color of the submit button */
    padding: 12px 20px; /* Adds some padding to the submit button */
    border: none; /* Removes the border from the submit button */
    border-radius: 4px; /* Rounds the corners of the submit button */
    cursor: pointer; /* Changes the cursor to a pointer when hovered over the submit button */
    margin-top: 20px; /* Adds some margin between the submit button and the form elements */
    width: 100%; /* Makes the submit button take up the full width of the form */
}

button:hover {
    background-color: #45a049; /* Changes the background color of the submit button when hovered over */
}
.btn-gradient {
  background: linear-gradient(to right, #56ab2f, #a8e063);
  color: white;
  border: none;
  border-radius: 3px;
  padding: 10px 20px;
  transition: background 0.3s ease;
}

.btn-gradient:hover {
  background: linear-gradient(to right, #a8e063, #56ab2f);
}
.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}
            
        </style>
    </head>
    <body>
        
        
        <form class="order-form">
    <img src="../static/crazyphone.png" width="250" th:src="@{crazyphone.png}" class="center"/>
     
    <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" class="form-control" required>
    </div>
    <div class="form-group">
        <label for="address">Address Description:</label>
        <input type="text" id="address" name="address" class="form-control" required>
    </div>
    <div class="form-group">
        <label for="phone">Phone:</label>
        <input type="tel" id="phone" name="phone" class="form-control" required>
    </div>
    <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" class="form-control" required>
    </div>
    <div class="form-group">
        <label for="product">Product:</label>
        <select id="product" name="product" class="form-control" required>
            <option value="">Select a product</option>
            <option value="iphone">iPhone</option>
            <option value="samsung">Samsung</option>
            <option value="huawei">Huawei</option>
        </select>
    </div>
    <div class="form-group">
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" class="form-control" min="1" required>
    </div>
    <div class="form-group">
        <label for="color">Color:</label>
         <select id="color" name="color" class="form-control" required>
            <option value="">Select a Color</option>
            <option value="Black">Black</option>
            <option value="Blue">Blue</option>
            <option value="White">White</option>
        </select>
    </div>

    <div id="map"></div>
      <!--    <button id="save-location-btn">Save Location</button-->
       <Button id="save-order-btn" >Submit Order</Button>
    
       
    </form>
        
        
        <script>
        
     // request user's location
        navigator.geolocation.getCurrentPosition(function(location) {
            var lat = location.coords.latitude;
            var lng = location.coords.longitude;

            // set the map's view to the user's current location
            //map.setView([lat, lng], 13);
            var map = L.map('map').setView([lat, lng], 13);
            // this section is required for copyright reasons
            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);
            
            
            // this part set the longitude and latitude to the marker
            var marker = L.marker([lat, lng]).addTo(map);
            marker.bindPopup("I am a marker!").openPopup();
            map.on('click', function(e) {
                marker.setLatLng(e.latlng);
                marker.bindPopup("You clicked at " + e.latlng.toString()).openPopup();
            });
            
            
            var saveLocationBtn = document.getElementById('save-order-btn');
            saveLocationBtn.addEventListener('click', function() {
                var lat = marker.getLatLng().lat;
                var lng = marker.getLatLng().lng;
                var name = document.getElementById('name').value;
                var address =  document.getElementById('address').value;
                var email =  document.getElementById('email').value;
                var phone =  document.getElementById('phone').value;
                var product =  document.getElementById('product').value;
                var quantity =  document.getElementById('quantity').value;
                var color =  document.getElementById('color').value;
            
                
                
                // Use Fetch API or an AJAX library to send a request to your server to save the location to MongoDB
                // Example using Fetch API:
                fetch('/save-order', {
                    method: 'POST',
                    body: JSON.stringify({
                        lat: lat,
                        lng: lng,
                        name:name,
                        address:address,
                        email:email,
                        phone:phone,
                        product:product,
                        quantity:quantity,
                        color:color
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            });   
          });
        </script>
    </body>
</html>